---
title: "[ìë£Œêµ¬ì¡°] ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬(Segment Tree)"

categories: DataStructure

toc: true
toc_sticky: true

layout: single

show_Date: true
date: 2024-07-17
last_modified_at: 2024-07-17
---



# âšª<span style="color: #D6ABFA;">ì •ì˜</span>

- **ì—¬ëŸ¬ ê°œì˜ ë°ì´í„°ê°€ ì¡´ì¬í•  ë•Œ íŠ¹ì • êµ¬ê°„ì˜ í•©(ìµœì†Ÿê°’, ìµœëŒ“ê°’, ê³± ë“±)ì„ êµ¬í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ìë£Œêµ¬ì¡°**ì´ë‹¤.
- **íŠ¸ë¦¬ ì¢…ë¥˜ ì¤‘ì— í•˜ë‚˜ë¡œ ì´ì§„ íŠ¸ë¦¬ì˜ í˜•íƒœì´ë©°, íŠ¹ì • êµ¬ê°„ì˜ í•©ì„ ê°€ì¥ ë¹ ë¥´ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤**ëŠ” ì¥ì ì´ ìˆë‹¤. (`O(logN)`)

ì•„ë˜ ì˜ˆì œë¥¼ í†µí•´ `ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬(Segment Tree)`ë¥¼ ì™œ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œì•„ë³´ì.

> **(Ex)**
> ![img](https://velog.velcdn.com/images%2Fkimdukbae%2Fpost%2F0420123f-ab37-4159-b97e-263c015e6ee5%2Fimage.png)
>
> ìœ„ì™€ ê°™ì€ ë°°ì—´ì´ ìˆë‹¤ê³  í•˜ì.   
> ì´ ë•Œ ë°ì´í„°ì˜ ê°œìˆ˜ëŠ” 10ê°œë¡œ ì¸ë±ìŠ¤ëŠ” 0ë¶€í„° 9ê¹Œì§€ ì°¨ë¡€ëŒ€ë¡œ 1~10ì˜ ì›ì†Œê°€ ì‚½ì…ë˜ì–´ ìˆë‹¤.   
> ë§Œì•½ ì¸ë±ìŠ¤ 2ë¶€í„° 8ê¹Œì§€ ë°ì´í„°ë¥¼ ë”í•˜ë ¤ë©´ ì–´ë–»ê²Œ í• ê¹Œ?
>
> ![img](https://velog.velcdn.com/images%2Fkimdukbae%2Fpost%2Fc2b19f36-5787-4396-8f19-98409017d9d7%2Fimage.png)
>
> ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ 2~8 ë²”ìœ„ì˜ ì›ì†Œë¥¼ í•˜ë‚˜ì”© ë‹¤ ë”í•˜ë©´ ëœë‹¤. ê²°ê³¼ëŠ” 42ì´ë‹¤.   
> ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ë‹¤ë¥¸ íŠ¹ì • êµ¬ê°„ì˜ í•©ì„ êµ¬í•œë‹¤ê³  ê³ ë ¤í–ˆì„ ë•Œ ì•ì—ì„œ í•˜ë‚˜ì”© ë”í•˜ë¯€ë¡œ ë°ì´í„°ì˜ ê°œìˆ˜ê°€ Nì´ë©´ ì‹œê°„ ë³µì¡ë„ëŠ” **`O(N)`**ì´ë‹¤.   
> ë”°ë¼ì„œ ì´ëŸ¬í•œ ë°©ì‹ì„ ì´ìš©í•˜ë©´ êµ¬ê°„ì˜ í•©ì„ êµ¬í•˜ëŠ” ì†ë„ê°€ ë„ˆë¬´ ëŠë¦¬ê¸° ë•Œë¬¸ì— ë” ì¢‹ì€ ë°©ë²•ì´ í•„ìš”í•˜ë‹¤.

**â†’** ë” ì¢‹ì€ ë°©ë²•ì´ ë°”ë¡œ **`ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬(Segment Tree)`ë¥¼ ì‚¬ìš©**í•˜ëŠ” ê²ƒì´ë‹¤!

<br>

<br>

<br>

# âšª<span style="color: #D6ABFA;">ë™ì‘ ì›ë¦¬</span>

![img](../../assets/images/2024-07-17-SegmentTree/images%2Fkimdukbae%2Fpost%2Fa228321e-2e5d-4310-b57c-7b6c87aec291%2Fimage.png)

> íŠ¸ë¦¬ì˜ ë£¨íŠ¸ ì¸ë±ìŠ¤ëŠ” 1ë¶€í„° ì‹œì‘í•˜ëŠ” ê²ƒì´ ê³„ì‚°í•˜ê¸° í¸í•¨  
> (ì™¼ìª½ ìì‹ì€ x2, ì˜¤ë¥¸ìª½ ìì‹ì€ x2 +1)  
> (ë¶€ëª¨ëŠ” /2)

## ğŸ”¹ì´ˆê¸°í™” ë° ìƒì„±

**ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ í¬ê¸°ëŠ” ë°°ì—´(arr)ì˜ ê°œìˆ˜ê°€ Nê°œì¼ ë•Œ, Në³´ë‹¤ í° ê°€ì¥ ê°€ê¹Œìš´ Nì˜ ì œê³±ìˆ˜ë¥¼ êµ¬í•œ ë’¤ì— ê·¸ê²ƒì˜ 2ë°°ë¥¼ í•˜ì—¬ ë¯¸ë¦¬ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ í¬ê¸°ë¥¼ ë§Œë“¤ì–´ë†“ì–´ì•¼ í•œë‹¤.** (ë„‰ë„‰í•˜ê²Œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ë‹¤). 

ê·¸ë˜ì„œ **ì‹¤ì œë¡œëŠ” ë°ì´í„°ì˜ ê°œìˆ˜ Nì— 4ë¥¼ ê³±í•œ í¬ê¸°ë§Œí¼ ë¯¸ë¦¬ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ í¬ê¸°ë¥¼ í• ë‹¹í•œë‹¤.**

start~end ì¸ë±ìŠ¤ì˜ ê°’ì˜ í•©ì´ ê° ë…¸ë“œì— ì´ˆê¸°ê°’ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.

```cpp
// <ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ ë°°ì—´ì˜ ê° êµ¬ê°„ í•©ìœ¼ë¡œ ì±„ì›Œì£¼ê¸°>
// start : ë°°ì—´ì˜ ì‹œì‘ ì¸ë±ìŠ¤, end : ë°°ì—´ì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤
// index : ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ ì¸ë±ìŠ¤ (ë¬´ì¡°ê±´ 1ë¶€í„° ì‹œì‘)
int init(int start, int end, int index)
{
    //ê°€ì¥ ëì— ë„ë‹¬í–ˆìœ¼ë©´ arr ì‚½ì…
    if (start == end)
    {
        tree[index] = arr[start];
        return tree[index];
    }
    int mid = (start + end) / 2;
    
    //ì¢Œì¸¡ ë…¸ë“œì™€ ìš°ì¸¡ ë…¸ë“œë¥¼ ì±„ì›Œì£¼ë©´ì„œ ë¶€ëª¨ ë…¸ë“œì˜ ê°’ë„ ì±„ì›Œì¤€ë‹¤.
    tree[index] = init(start, mid, index * 2) + init(mid + 1, end, index * 2 + 1);
    return tree[index];
}
```

## ğŸ”¹êµ¬ê°„ í•© êµ¬í•˜ê¸°

![img](../../assets/images/2024-07-17-SegmentTree/images%2Fkimdukbae%2Fpost%2F995a2d63-aa7c-4faf-81e3-0c3f1556c470%2Fimage.png)

ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ì´ê¸° ë•Œë¬¸ì— ë°ì´í„°ë¥¼ íƒìƒ‰í•˜ëŠ”ë° ìˆì–´ `O(logN)`ì˜ ì‹œê°„ ë³µì¡ë„ë¥¼ ê°€ì§„ë‹¤. ë”°ë¼ì„œ êµ¬ê°„ í•©ì„ í•­ìƒ `O(logN)`ì˜ ì‹œê°„ì— êµ¬í•  ìˆ˜ ìˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ 6~9ì˜ ë²”ìœ„ì˜ êµ¬ê°„ í•©ì„ êµ¬í•œë‹¤ê³  í•˜ì. ê·¸ëŸ¬ë©´ 3ê°œì˜ ë¹¨ê°„ìƒ‰ ë…¸ë“œì˜ í•©ë§Œ êµ¬í•´ì£¼ë©´ ëœë‹¤.

êµ¬ê°„ì˜ í•© êµ¬í•˜ëŠ” í•¨ìˆ˜ ë˜í•œ ì¬ê·€ì ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.   
êµ¬ê°„ì˜ í•©ì€ **'ë²”ìœ„ ì•ˆì— ìˆëŠ” ê²½ìš°'**ì— í•œí•´ì„œë§Œ ë”í•´ì£¼ë©´ ëœë‹¤. ê·¸ ë°–ì˜ ê²½ìš°ëŠ” ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤!

```cpp
// êµ¬ê°„ í•©ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜
// start : ì‹œì‘ ì¸ë±ìŠ¤, end : ë§ˆì§€ë§‰ ì¸ë±ìŠ¤
// left, right : êµ¬ê°„ í•©ì„ êµ¬í•˜ê³ ì í•˜ëŠ” ë²”ìœ„
int interval_sum(int start, int end, int index, int left, int right)
{
    // ë²”ìœ„ ë°–ì— ìˆëŠ” ê²½ìš°
    if (left > end || right < start)
    {
        return 0;
    }
    // ë²”ìœ„ ì•ˆì— ìˆëŠ” ê²½ìš°
    if (left <= start && right >= end)
    {
        return tree[index];
    }
    // ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ í•©ì„ êµ¬í•˜ê¸°
    int mid = (start + end) / 2;
    // startì™€ endê°€ ë³€í•˜ë©´ì„œ êµ¬ê°„ í•©ì¸ ë¶€ë¶„ì„ ë”í•´ì¤€ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.
    return interval_sum(start, mid, index * 2, left, right) + interval_sum(mid + 1, end, index * 2 + 1, left, right);
}
```

## ğŸ”¹íŠ¹ì • ì›ì†Œ ê°’ ìˆ˜ì •

![img](../../assets/images/2024-07-17-SegmentTree/images%2Fkimdukbae%2Fpost%2F52ee2049-798e-444d-8419-12c5b3c79618%2Fimage.png)

íŠ¹ì • ì›ì†Œë¥¼ ìˆ˜ì •í•˜ë©´ êµ¬ê°„ì˜ í•©ë“¤ì´ ë‹¬ë¼ì§€ê³ , ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ ì›ì†Œê°’ë“¤ë„ ë‹¹ì—°íˆ ë‹¬ë¼ì§„ë‹¤.  
 ë”°ë¼ì„œ íŠ¹ì • ì›ì†Œì˜ ê°’ì„ ìˆ˜ì •í•  ë•ŒëŠ” **í•´ë‹¹ ì›ì†Œë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ëª¨ë“  êµ¬ê°„ í•© ë…¸ë“œë“¤ì„ ê°±ì‹ **í•´ì£¼ë©´ ëœë‹¤.   
ì¦‰, ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ ëª¨ë“  ë…¸ë“œë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ í•´ë‹¹ ì›ì†Œë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ë¶€ë¶„ì ì¸ ë…¸ë“œë“¤ë§Œ ë°”ê¿”ì£¼ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì¸ë±ìŠ¤ 6ì˜ arrê°’(`arr[6]`)ì„ ìˆ˜ì •í•œë‹¤ê³  í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ 5ê°œì˜ êµ¬ê°„ í•© ë…¸ë“œë¥¼ ëª¨ë‘ ìˆ˜ì •í•˜ë©´ ëœë‹¤.

ì´ í•¨ìˆ˜ ë˜í•œ ì¬ê·€ì ìœ¼ë¡œ êµ¬í˜„í•˜ë©°, ìˆ˜ì •í•  ë…¸ë“œë¡œëŠ” 'ë²”ìœ„ ì•ˆì— ìˆëŠ” ê²½ìš°'ì— í•œí•´ì„œë§Œ ìˆ˜ì •í•´ì¤€ë‹¤.

```cpp
// íŠ¹ì • ì›ì†Œì˜ ê°’ì„ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
// start : ì‹œì‘ ì¸ë±ìŠ¤, end : ë§ˆì§€ë§‰ ì¸ë±ìŠ¤
// what : êµ¬ê°„ í•©ì„ ìˆ˜ì •í•˜ê³ ì í•˜ëŠ” ë…¸ë“œ (ì¦‰ ë°°ì—´ì—ì„œì˜ ì¸ë±ìŠ¤)
// value : ê¸°ì¡´ê°’ì—ì„œ ì–¼ë§ˆë‚˜ ìˆ˜ì •í•˜ëŠ”ì§€(ex.6->8ë¡œ ìˆ˜ì •ì´ë©´ 2)
void update(int start, int end, int index, int what, int value)
{
    // ë²”ìœ„ ë°–ì— ìˆëŠ” ê²½ìš°
    if (what < start || what > end)
    {
        return;
    }
    // ë²”ìœ„ ì•ˆì— ìˆìœ¼ë©´ ë‚´ë ¤ê°€ë©´ì„œ ë‹¤ë¥¸ ì›ì†Œë„ ê°±ì‹ 
    tree[index] += value;
    if (start == end)
    {
        return;
    }
    int mid = (start + end) / 2;
    update(start, mid, index * 2, what, value);
    update(mid + 1, end, index * 2 + 1, what, value);
}
```



<br>

<br>

<br>

# âšª<span style="color: #D6ABFA;">ì½”ë“œ</span>

```cpp
#include <iostream>
#include <vector>

using namespace std;

vector<int> tree;
vector<int> arr={1,2,3,4,5,6,7,8,9,10};

// <ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ ë°°ì—´ì˜ ê° êµ¬ê°„ í•©ìœ¼ë¡œ ì±„ì›Œì£¼ê¸°>
// start : ë°°ì—´ì˜ ì‹œì‘ ì¸ë±ìŠ¤, end : ë°°ì—´ì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤
// index : ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì˜ ì¸ë±ìŠ¤ (ë¬´ì¡°ê±´ 1ë¶€í„° ì‹œì‘)
int init(int start, int end, int index)
{
    //ê°€ì¥ ëì— ë„ë‹¬í–ˆìœ¼ë©´ arr ì‚½ì…
    if (start == end)
    {
        tree[index] = arr[start];
        return tree[index];
    }
    int mid = (start + end) / 2;

    //ì¢Œì¸¡ ë…¸ë“œì™€ ìš°ì¸¡ ë…¸ë“œë¥¼ ì±„ì›Œì£¼ë©´ì„œ ë¶€ëª¨ ë…¸ë“œì˜ ê°’ë„ ì±„ì›Œì¤€ë‹¤.
    tree[index] = init(start, mid, index * 2) + init(mid + 1, end, index * 2 + 1);
    return tree[index];
}

// êµ¬ê°„ í•©ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜
// start : ì‹œì‘ ì¸ë±ìŠ¤, end : ë§ˆì§€ë§‰ ì¸ë±ìŠ¤
// left, right : êµ¬ê°„ í•©ì„ êµ¬í•˜ê³ ì í•˜ëŠ” ë²”ìœ„
int interval_sum(int start, int end, int index, int left, int right)
{
    // ë²”ìœ„ ë°–ì— ìˆëŠ” ê²½ìš°
    if (left > end || right < start)
    {
        return 0;
    }
    // ë²”ìœ„ ì•ˆì— ìˆëŠ” ê²½ìš°
    if (left <= start && right >= end)
    {
        return tree[index];
    }
    // ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ í•©ì„ êµ¬í•˜ê¸°
    int mid = (start + end) / 2;
    // startì™€ endê°€ ë³€í•˜ë©´ì„œ êµ¬ê°„ í•©ì¸ ë¶€ë¶„ì„ ë”í•´ì¤€ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.
    return interval_sum(start, mid, index * 2, left, right) + interval_sum(mid + 1, end, index * 2 + 1, left, right);
}

// íŠ¹ì • ì›ì†Œì˜ ê°’ì„ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
// start : ì‹œì‘ ì¸ë±ìŠ¤, end : ë§ˆì§€ë§‰ ì¸ë±ìŠ¤
// what : êµ¬ê°„ í•©ì„ ìˆ˜ì •í•˜ê³ ì í•˜ëŠ” ë…¸ë“œ (ì¦‰ ë°°ì—´ì—ì„œì˜ ì¸ë±ìŠ¤)
// value : ê¸°ì¡´ê°’ì—ì„œ ì–¼ë§ˆë‚˜ ìˆ˜ì •í•˜ëŠ”ì§€(ex.6->8ë¡œ ìˆ˜ì •ì´ë©´ 2)
void update(int start, int end, int index, int what, int value)
{
    // ë²”ìœ„ ë°–ì— ìˆëŠ” ê²½ìš°
    if (what < start || what > end)
    {
        return;
    }
    // ë²”ìœ„ ì•ˆì— ìˆìœ¼ë©´ ë‚´ë ¤ê°€ë©´ì„œ ë‹¤ë¥¸ ì›ì†Œë„ ê°±ì‹ 
    tree[index] += value;
    if (start == end)
    {
        return;
    }
    int mid = (start + end) / 2;
    update(start, mid, index * 2, what, value);
    update(mid + 1, end, index * 2 + 1, what, value);
}



int main()
{
    //íŠ¸ë¦¬ í¬ê¸° ì„¤ì •(ë°ì´í„° ê°œìˆ˜ x 4)
    int treeSize = arr.size() * 4;
    tree.resize(treeSize);
    
    //ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ ì´ˆê¸°í™”
    init(0, arr.size() - 1, 1);
    
    //êµ¬ê°„ í•© ì¶œë ¥
    cout<<"0~9ì¸ë±ìŠ¤ê¹Œì§€ì˜ í•© : ";
    cout<<interval_sum(0, arr.size() - 1, 1, 0, 9)<<endl; //ë°°ì—´ì˜ 0~9ì¸ë±ìŠ¤ ê¹Œì§€ì˜ í•©
    cout<<"2~5ì¸ë±ìŠ¤ê¹Œì§€ì˜ í•© : ";
    cout<<interval_sum(0, arr.size() - 1, 1, 2, 5)<<endl; //ë°°ì—´ì˜ 2~5ì¸ë±ìŠ¤ ê¹Œì§€ì˜ í•©
    
    //íŠ¹ì • ì›ì†Œ ìˆ˜ì •
    update(0, arr.size() - 1, 1, 5, 2); //5ë²ˆì§¸ ì¸ë±ìŠ¤ì˜ ê°’ì„ 2ë§Œí¼ ì¦ê°€
    
    //êµ¬ê°„ í•© ì¶œë ¥
    cout<<"5ë²ˆì§¸ ì¸ë±ìŠ¤ì˜ ê°’ì„ 2ë§Œí¼ ì¦ê°€í•œ ì´í›„ 0~9ì¸ë±ìŠ¤ ê°’ í•©:";
    cout<<interval_sum(0, arr.size() - 1, 1, 0, 9)<<endl; //ë°°ì—´ì˜ 0~9ì¸ë±ìŠ¤ ê¹Œì§€ì˜ í•©
}
```

> **ì¶œë ¥ ê²°ê³¼: ** 
>
> 0~9ì¸ë±ìŠ¤ê¹Œì§€ì˜ í•© : 55  
> 2~5ì¸ë±ìŠ¤ê¹Œì§€ì˜ í•© : 18  
> 5ë²ˆì§¸ ì¸ë±ìŠ¤ì˜ ê°’ì„ 2ë§Œí¼ ì¦ê°€í•œ ì´í›„ 0~9ì¸ë±ìŠ¤ ê°’ í•©:57

<br>

<br>

<br>

# âšª<span style="color: #D6ABFA;">ì‹œê°„ ë³µì¡ë„</span>

- ì‹œê°„ ë³µì¡ë„ëŠ” `O(logN)`ìœ¼ë¡œ, ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ ì´ìš©í•˜ë©´ ê¸°ì¡´ì˜ êµ¬ê°„ í•©ì„ ê³„ì‚°í•  ë•Œ í›¨ì”¬ ë” ë¹ ë¥´ê²Œ êµ¬ê°„ í•©ì„ êµ¬í•  ìˆ˜ ìˆë‹¤.
